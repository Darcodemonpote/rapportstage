"use strict";(self.webpackChunkmon_wiki=self.webpackChunkmon_wiki||[]).push([[102],{195:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/talend-ac3cb7d946e65afd692a5e9c8f3d376c.png"},1653:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/date-a0b909594a2e7deb8a8104051b423556.png"},3740:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"sujet1-talend-dates","title":"sujet1-talend-dates","description":"Contexte","source":"@site/docs/sujet1-talend-dates.md","sourceDirName":".","slug":"/sujet1-talend-dates","permalink":"/rapportstage/sujet1-talend-dates","draft":false,"unlisted":false,"editUrl":"https://github.com/Darcodemonpote/rapportstage/edit/main/docs/sujet1-talend-dates.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"outils","permalink":"/rapportstage/outils"},"next":{"title":"sujet2-resynchro-prodauto","permalink":"/rapportstage/sujet2-resynchro-prodauto"}}');var r=s(4848),i=s(8453);const a={},l=void 0,o={},d=[{value:"Contexte",id:"contexte",level:3},{value:"Objectif",id:"objectif",level:3},{value:"Travail r\xe9alis\xe9",id:"travail-r\xe9alis\xe9",level:3},{value:"R\xe9sultat",id:"r\xe9sultat",level:3},{value:"Sch\xe9ma de flux simplifi\xe9",id:"sch\xe9ma-de-flux-simplifi\xe9",level:3}];function c(e){const n={br:"br",code:"code",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h3,{id:"contexte",children:"Contexte"}),"\n",(0,r.jsxs)(n.p,{children:["Dans le cadre de la ",(0,r.jsx)(n.strong,{children:"migration de la plateforme Big Data de CDH vers CDP"}),", certains comportements ind\xe9sirables sont apparus, notamment une erreur sur le ",(0,r.jsx)(n.strong,{children:"traitement des dates"})," :\r\nLes valeurs qui \xe9taient auparavant exprim\xe9es en ",(0,r.jsx)(n.strong,{children:"CET"})," (Central European Time) apparaissaient d\xe9sormais en ",(0,r.jsx)(n.strong,{children:"UTC"})," (Coordinated Universal Time), entra\xeenant des incoh\xe9rences dans les analyses et les traitements m\xe9tiers."]}),"\n",(0,r.jsxs)(n.p,{children:["Ce d\xe9calage de fuseau horaire est d\xfb \xe0 la configuration par d\xe9faut des composants Talend dans le nouvel environnement, ",(0,r.jsx)(n.strong,{children:"notamment parce que les jobs migr\xe9s de Talend 7 (avec Impala) vers Talend 8 (avec Kudu) ont h\xe9rit\xe9 du comportement de gestion des dates propre \xe0 Kudu, qui stocke les dates en UTC par d\xe9faut"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Ce changement discret mais syst\xe9matique pouvait fausser la logique des calculs temporels (ex. : dur\xe9es, dates d'\xe9ch\xe9ance, journaux, etc.)."}),"\n",(0,r.jsx)(n.h3,{id:"objectif",children:"Objectif"}),"\n",(0,r.jsxs)(n.p,{children:["Garantir l\u2019",(0,r.jsx)(n.strong,{children:"isofonctionnalit\xe9"})," entre les traitements CDH et CDP en identifiant et corrigeant tous les jobs Talend concern\xe9s par ce bug de date. L'objectif \xe9tait d\u2019\xe9viter toute r\xe9gression fonctionnelle li\xe9e \xe0 un changement de fuseau horaire implicite."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"travail-r\xe9alis\xe9",children:"Travail r\xe9alis\xe9"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Comparaison des donn\xe9es"})," entre l\u2019ancien environnement CDH et le nouvel environnement CDP \xe0 l\u2019aide de requ\xeates SQL sur Hue."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Analyse des jobs Talend"})," pour identifier les composants utilisant des champs de date sans gestion explicite du fuseau horaire."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Modification des composants"})," Talend, g\xe9n\xe9ralement les ",(0,r.jsx)(n.code,{children:"tMap"}),", afin d'int\xe9grer le bon format ou de forcer la conversion en CET.\r\n",(0,r.jsx)(n.img,{alt:"image",src:s(195).A+"",width:"1522",height:"568"}),"\r\n",(0,r.jsx)(n.img,{alt:"image",src:s(1653).A+"",width:"1888",height:"807"}),(0,r.jsx)(n.br,{}),"\n","Ici il s'agit d'appliquer la formule: source.variable != null ?\r\nBigDataParserUtils.parseTo_Date(DateTimeZone.applyTimeZoneDS( \"yyyy-MM-dd HH:mm",":ss",'.SSS", source.variable  , "CET"), "yyyy-MM-dd HH:mm',":ss",'.SSS"): null ',(0,r.jsx)(n.br,{}),"\n","Ce qui v\xe9rifie que le chant existe, et que si c'est le cas on en change le fuseau horaire"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tests"})," sur ",(0,r.jsx)(n.code,{children:"bd0"}),", pour valider les modifications sans g\xe9n\xe9rer de nouvelles erreurs, puis les int\xe9grateurs font les tests en pr\xe9-production avant de le mettre en place en production."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"r\xe9sultat",children:"R\xe9sultat"}),"\n",(0,r.jsxs)(n.p,{children:["Probl\xe8me corrig\xe9 sur plusieurs jeux de donn\xe9es critiques.\r\nLes jobs mis \xe0 jour ont \xe9t\xe9 livr\xe9s en ",(0,r.jsx)(n.strong,{children:"coproj"})," puis ",(0,r.jsx)(n.strong,{children:"valid\xe9s par les \xe9quipes m\xe9tiers"}),", avec une confirmation de conformit\xe9 fonctionnelle.\r\nLa correction a ensuite \xe9t\xe9 r\xe9pliqu\xe9e sur d'autres jobs similaires \xe0 l'aide de scripts automatis\xe9s."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"sch\xe9ma-de-flux-simplifi\xe9",children:"Sch\xe9ma de flux simplifi\xe9"}),"\n",(0,r.jsx)(n.p,{children:"Voici une illustration du pipeline de correction :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[ Regarder les composants o\xf9 il y a de potentielles modifications]\r\n                           \u2193\r\n[ Hue (CDH) ]       [ Hue (CDP) ]\r\n      \u2193                  \u2193\r\n[ Comparaison SQL ] \u2190\u2192 [ Extraction de diff\xe9rences ]\r\n      \u2193\r\n[ Job Talend identifi\xe9 ]\r\n      \u2193\r\n[ Correction fuseau horaire ]\r\n      \u2193\r\n[ D\xe9ploiement (bd0 \u2192 bt1 \u2192 perf) ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Les diff\xe9rents sujets sur lesquels j'ai travaill\xe9 avaient \xe9t\xe9 r\xe9pertori\xe9s sur un grand fichier excel, et je notais \xe0 mesure que je les terminais, et, quand n\xe9cessaire, demandait la cr\xe9ation d'un tiquet sur Jira et y indiquais les modifications apport\xe9s.\r\n",(0,r.jsx)(n.img,{alt:"excel",src:s(8059).A+"",width:"1592",height:"657"})]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8059:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/excel-bcdec90ee515b6694fa95dbd14c927ba.png"},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var t=s(6540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);